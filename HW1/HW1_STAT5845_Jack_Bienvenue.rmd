---
title: "Homework 1 - Replicating Covid Charts"
author: Jack Bienvenue
date: 25 August 2025
format: pdf
header-includes:
  - \usepackage{tcolorbox}
  - \tcbset{colback=red!10!white, colframe=red!80!black, boxrule=0.5pt, arc=3pt, left=6pt, right=6pt, top=6pt, bottom=6pt}
  - \usepackage{xcolor}
  - \newcommand{\red}[1]{\textcolor{red}{#1}}
---

``` {r, echo=FALSE}
# Preliminaries --> Package and Data Import, Data Cleaning

# Package Import
invisible(lapply(c("ggplot2", "dplyr", "tidyr", "sf", "stringr", "tigris", "RColorBrewer"),
  function(pkg) {
    suppressWarnings(suppressMessages(
      library(pkg, character.only = TRUE)))}))

# Data Import

## NYT COVID data
pre_us_counties_2020_df <- read.csv("./data/us-counties-2020.csv")
us_df <- read.csv("./data/us.csv")
us_states_df <- read.csv("./data/us-states.csv")

## County Shapefiles

options(tigris_use_cache = TRUE)  # for quickness
counties_sf <- counties(cb = TRUE, year = 2020, class = "sf")

# Data Cleaning

## Making County, State names compatible:

### US County Covid Cases
us_counties_2020_df <- pre_us_counties_2020_df %>%
  mutate(
    fips = sprintf("%05s", fips),
    fips = as.character(fips),
    county = str_to_lower(county),
    state = str_to_lower(state),
    date = as.Date(date)
  ) %>%
  filter(date ==as.Date("2020-08-31")) # Pick out 8/31/20

### US County shapefiles (Contig. 48 only!)

us_counties_shp <- counties_sf %>%
  mutate(fips = as.character(GEOID)) %>%
  filter( !STATE_NAME %in% c(
      "Alaska", "Hawaii", 
      "Puerto Rico", 
      "American Samoa", 
      "Guam", 
      "Commonwealth of the Northern Mariana Islands", 
      "United States Virgin Islands"))

## Spatially joining data to make map:
joined_map <- left_join(us_counties_shp, us_counties_2020_df, by = "fips")
```

---

## Figure 1: Data over Space---County-wise COVID Cases

```{=tex}
\raggedright
```

```{r}
View(joined_map)
```

*Data used: us-counties-2020.csv, 2020 TIGER County Shapefiles*

```{r}
ggplot(joined_map) +
  geom_sf(aes(fill = cases), color = "white", size = 0.1) +
  coord_sf(crs = 3083) +  # Lambert projection
  theme_minimal() +
  scale_fill_distiller(palette = "YlOrRd", direction = 1) +
  labs(
    title = "COVID-19 Cases by County on 2020-08-31",
    fill = "COVID-19 Cases",
    caption = "Source:https://www.nytimes.com/interactive/2021/us/covid-cases.html"
  ) +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold", size=9),
    plot.caption = element_text(hjust = 0, face = "bold", size = 7, family = "mono"),  
    legend.title = element_text(size = 7, face = "bold"),
    legend.text = element_text(size = 6),       
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_blank()
  )
```

```{=tex}
\centering{\red{Question: What patterns do you notice in this map?}}

\begin{tcolorbox}
It appears that urban areas have far greater case counts than rural counterparts, particularly in the American South. For instance, LA County,  Miami-Dade county, Maricopa (Phoeniz, AZ) County, Clark (Las Vegas, NV) County, and Harris (Houston, TX) County, appear to be hotspots.

I also notice the presence of spatial clustering of both high-- and low-count counties. Often, suburbs form gradients from low to high case count areas between high-- and low-clusters.
\end{tcolorbox}
```

---

## Figure 2: Data over Time---US COVID Case Time Series

```{=tex}
\raggedright
```

*Data used: us.csv*

```{r}

```

```{=tex}
\centering{\red{Question: Looking at this time series, what future behavior would you expect?}}

\begin{tcolorbox}

\end{tcolorbox}
```

---

## Figure 3: Data over Space & Time---State-partitioned COVID Case Time Series

```{=tex}
\raggedright
```

*Data used: us-states.csv*

```{r}

```

```{=tex}
\centering{\red{Question: Do all states follow the same pattern, or do some rise and fall earlier than others?}}

\begin{tcolorbox}

\end{tcolorbox}
```
