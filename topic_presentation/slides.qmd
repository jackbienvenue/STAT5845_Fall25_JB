---
title: "An Introduction to Outage Prediction Modeling"
format: 
 revealjs:
  slideNumber: true
  theme: white
  include-in-header: 
   text: |
    <style>
    .v-center-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 90%;
    }
    </style>
highlight-style: "github"  
footer: "Jack Bienvenue | STAT5845" 
preview-links: false
css: "columns.css"
---

<style>
  .container {
    display: flex;
    gap: 20px; /* space between columns */
    align-items: flex-start; /* aligns top of both columns */
  }

  .col {
    flex: 1;
    text-align: center;
  }

  .col img {
    height: 400px; /* desired uniform height */
    width: auto;   /* maintain aspect ratio */
    display: block;
    margin: 0 auto;
  }

  .text-box {
  background-color: rgba(0,0,0,0.6);
  padding: 20px;
  border-radius: 12px;
  display: inline-block;
  color: white; 
}

</style>

<!-- ─── Slide 2: Introduction ─── -->

<section data-auto-animate data-background-image="images/snowy_tree_on_lines.png">

<div style="background-color: rgba(0, 0, 0, 0.6); 
              padding: 10px; 
              border-radius: 6px; 
              display: inline-block; 
              margin-top: 0px;">
  <h1 style="text-align: center; color: white;">Problem Background</h1>
  </div>

<div style="background-color: rgba(0, 0, 0, 0.6); 
              padding: 10px; 
              border-radius: 6px; 
              display: inline-block; 
              margin-top: 20px;">
  <p style="text-align: left; color: lightgray;">Power outages threaten human life, stifle local economies and education, and lead to dangerous conditions. Modern approaches to building outage prediction models (OPMs) use a variety of methods from simple linear regression to ensemble machine learning methods. </p>
 </div>

<div style="background-color: rgba(0, 0, 0, 0.6); 
              padding: 10px; 
              border-radius: 6px; 
              display: inline-block; 
              margin-top: 20px;">
 <p style="text-align: center; color: white;"> <b>My task was to deploy a transparent statistical method for predicting customer outages town-by-town for the state of Connecticut.</b> </p>
 </div>

</section>

<!-- ─── Slide 3: --------- ─── -->

<section data-auto-animate>
  <h1 style="margin-top: 15px; color: forestgreen; text-align: center;">Problem Paradigm</h1>
  <p style="text-align: center;"><b>We must focus on extreme observations for Outage Prediction Models (OPMs).</b></p>
  <div class="container">
  <div class="col">
  <img src="images/ECDFs.png" alt="Animation" style="display: block; margin: 0 auto; width=100%; height=100%">
  </div>
  <div class="col">
  <h3><em></em></h3>
  <img src="images/2D_scatterplot_z_scores.png" alt="Animation" style="display: block; margin: 0 auto; width=100%; height=100%">
  </div>
  </div>
</section>

<!-- ─── Slide 4: ------ ─── -->

<section data-auto-animate data-background="images/Area_of_Study_map_background.png" data-background-repeat="repeat" data-background-size="300px">

  <div style="background-color: rgba(62, 64, 61, 0.65); 
              padding: 10px; 
              border-radius: 6px; 
              display: inline-block; 
              margin-top: 20px;">
  <h3 style="color: black; text-align: center; margin-top: 0px;"> <em>How can we organize the effort to predict outages? </em> </h3>
  </div>

   <div style="background-color: rgba(62, 64, 61, 0.65); 
              padding: 10px; 
              border-radius: 6px; 
              display: inline-block; 
              margin-top: 40px;">
  <h3 class="fragment" style="text-align: center;"> By constructing a statistical framework, but...</h3> 
  </div>

<div style="background-color: rgba(62, 64, 61, 0.65); 
              padding: 38px; 
              border-radius: 6px; 
              display: inline-block; 
              margin-top: 40px;">
  <h3 class="fragment" style="text-align: center; color: white; margin-top: 0px;">   Spatial Data Processing is Essential to Begin</h3> 
  </div>
</section>

<!-- ─── Slide 5: ------ ─── -->

<section data-auto-animate>

  <h3 style="text-align: center; margin-top: 20px;"> Spatial Data Processing is Essential to Begin</h3>

  <h3 class="fragment" style="text-align: left ; margin-top: 40px; color: forestgreen;"> Data Sources</h3> 

  <ul>
    <li class="fragment">European Centre for Medium-Range Weather Forecasting (ECMWF) -- 40+ years of Connecticut weather data</li>
    <li class="fragment">Eversource -- Outage Data</li>
    <li class="fragment">Eversource Energy Center -- Classified weather events</li>
    <li class="fragment">Census Bureau -- Shapefiles for CT towns</li>
  </ul>

  <h3 class="fragment" style="text-align: center; color: forestgreen; margin-top: 20px;"> Let's Inspect the Data's Spatial Organization</h3> 

</section>

<!-- ─── Slide 6: ------ ─── -->

<section data-auto-animate>
  <h3 style="text-align: center; margin-top: 0px;"> Let's Inspect the Data's Spatial Organization</h3> 
  <p style="text-align: center;"> Here are the locations of weather data records: </p>
<div style="text-align: center;">
  <iframe
    src="embed/trial_point_map.html"
    width="85%"
    height="450"
    style="border: none;">
  </iframe>
  <h3 style="text-align: center; margin-top: 0px;">  Expression as a Lattice</h3> 
</div>
</section>

<!-- ─── Slide 7: ------ ─── -->

<section data-auto-animate>
  <h3 style="text-align: center; margin-top: 0px;"> Expression as a Lattice </h3> 
  <p style="text-align: center;"> 2D visual of interpolated geostatistical data: </p>
<div style="text-align: center;">
  <iframe
    src="embed/shapefile_build.html"
    width="85%"
    height="425"
    style="border: none;">
  </iframe>
</div>
  <h3 style="text-align: center;"> Still, an Issue Remains </h3>
</section>

<!-- Slide 8: ───  ─── -->

<section data-auto-animate>
  <h3 style="text-align: center;"> Still, an issue remains </h3>
  <p> How do we resolve the difference in input weather data and our geographic regions of interest (ROIs)--Connecticut's towns?</p>
<div style="text-align: center;">
  <img src="images/Weather_Data_Assignment_Figure.png" style="max-width: 70%; margin: 10px;">
</div>
</section>

<!-- Slide 9: ───  ─── -->

<section data-auto-animate 
         data-background="images/tree_falling.gif" 
         data-background-repeat="repeat" 
         data-background-size="550px">

  <div style="background-color: rgba(0, 0, 0, 0.6); 
              padding: 20px; 
              border-radius: 12px; 
              display: inline-block; 
              margin-top: 75px;">

 <h1 style="text-align: center; color: white; margin: 0;">Back to Outages</h1>
  </div>

  <div class="fragment" 
       style="background-color: rgba(0, 0, 0, 0.6); 
              padding: 15px; 
              border-radius: 12px; 
              display: inline-block; 
              margin-top: 40px;">

<h3 style="text-align: center; color: white; margin: 0;">How do we represent a storm for modeling?</h3>
  </div>

</section>


---

## Predictor Variable Selection

We define a standard selection method of covariates, seeking representative data that captures the most outage-relevant information from a storm.

\begin{equation}
\label{eq:precip_intensity_window_selection}
\text{Precipitation Intensity} := I_{\text{max}} = \max_{t = 0,\dots,24} \left( \frac{1}{24} \sum_{i=0}^{23} I_{t+i} \right)
\end{equation}

\begin{equation}
\label{eq:wind_velocity_window_selection}
\text{Wind Velocity} := W_{\text{max}} = \max_{t = 0,\dots,24} \left( \frac{1}{24} \sum_{i=0}^{23} W_{t+i} \right)
\end{equation}

Here, we maximize a 24-hr average over a moving window.

---

<!-- Slide 11: ───  ─── -->
<section data-auto-animate>
  <h3 style="text-align: center; margin-top: 10px"> Capturing Extreme Events</h3>
  <h2 class="fragment" style ="color:forestgreen;"> A Standard Normal Transformation </h2>
  <p class="fragment"> Without parameterizing the distributions for covariates, we can still identify extreme events. </p>
  <ul>
    <li class="fragment"> Sort covariates (e.g. $W_{asc} = W_{(1)}, W_{(2)}, \dots, W_{(n)}$)</li>
    <li class="fragment" style="color: gray">Construct Empirical Cumulative Distribution Function, quantiles</li>
    <li class="fragment">Use inverse normal CDF transformation ($\Phi^{-1}$) to z-score data (NOTE: Preserve mapping function!) </li>
  </ul>
  <h2 style="color: white;">
  Best Linear Unbiased Estimation (<span style="color: white;">BLUE</span>) Model:
</h2>
</section>

<!-- Slide 12: ───  ─── -->
<section data-auto-animate>
 <h2 style="color: black;">
  Best Linear Unbiased Estimation (<span style="color: blue;">BLUE</span>) Model:
</h2>

<p>
$$
\widehat{\underline{X_1}}\left(\underline{x_2}\right) = m_{X_1} + \underline{\underline{\Sigma^{\phantom{a}}_{X_1X_2}}} \times \underline{\underline{\Sigma^{-1}_{X_2X_2}}}\left(\smash{\underline{\underline{x_2}}} - \underline{m_{X_2}}\phantom{A}\right),
$$ 
</p>

<p>For every town, we use our **normalized** predictors and **normalized** outage counts, to use leave-one-out cross validation (LOOCV) to assess model accuracy. </p>

<p>NOTE: The (<span style="color: blue;">BLUE</span>) model predicts the z-score of outage counts.</p>

<div class="fragment">
 <h2 style="text-align:center;">LOOCV Review</h2>
 </div>
</section>

<!-- Slide 13: ───  ─── -->
<section data-auto-animate>
  <h2 style="text-align: center; margin-top: 0px;"> LOOCV Review </h2> 
  <p style="text-align: center;"> LOOCV is an extreme of k-folds cross validation. It works by:</p>
  <ol>
    <li>Fitting model using $n-1$ data points.</li>
    <li>Predicting target variable</li>
    <li>Computing error statistic</li>
    <li>Repeat for all $i$, $i \in \{1...,n\}$, aggregating errors </li>
  </ol>
  <h3 style="text-align: center"> Scale Matters Here </h3>
</section>

<!-- Slide 14: ───  ─── -->
<section data-auto-animate>
    <h3 style="text-align: center; color:forestgreen"> Scale Matters Here </h3>
  <h2 style="text-align: center; margin-top: 0px;"> Translation back to Outage Counts </h2> 
  <p style="text-align: center;"> Remember normalizing our data using $\Phi^{-1}$? We are still in the Gaussian space and must transform back to the "time domain" (original scale) for LOOCV. The ECDF helps us do this.</p>
  <h3 style="text-align: center;"> We've created a non-parametric approach to predicting storm outages </h3>
</section>

<!-- Slide 15: ───  ─── -->
<section data-auto-animate>
    <h3 style="text-align: center;"> We've created a non-parametric approach to predicting storm outages </h3>
  
  <ul>
    <li> No assumptions on distribution of weather & outage data --> generalizable to any area,
    </li>
    <li> Allows relevant spatial partitioning of models, </li>
    <li> Achieves similar accuracy to more complex models with fewer inputs required and modest computation</li>
  </ul>
</section>

<!-- Slide (final): ───  ─── -->
<section data-background="images/conclusion.gif" data-background-repeat="repeat" data-background-size="400px">
  <div
       style="background-color: rgba(0, 0, 0, 0.6); 
              padding: 50px; 
              border-radius: 12px; 
              display: inline-block; 
              margin-top: 40px;">

<h1 style="text-align: center; color: white; margin: 0;">Thank you!</h1>
  </div>

  <div class="fragment" 
       style="background-color: rgba(0, 0, 0, 0.6); 
              padding: 50px; 
              border-radius: 12px; 
              display: inline-block; 
              margin-top: 40px;">

<h2 style="text-align: center; color: white; margin: 0;">Any Questions?</h2>
  </div>

</section>


## Scholarly References

<ol>
  <li id="ref1">McNamara, D. E., Smith, M. D., Williams, Z., Gopalakrishnan, S., & Landry, C. E. (2024). Policy and market forces delay real estate price declines on the US coast. Nature Communications, 15(1), 2209.</li>
  <li id="ref2">
  Rapach, D. E., & Strauss, J. K. (2009). 
  <i>Differences in housing price forecastability across US states</i>. 
  <i>International Journal of Forecasting, 25</i>(2), 351–372. 
  <a href="https://doi.org/10.1016/j.ijforecast.2009.01.009" target="_blank">
    https://doi.org/10.1016/j.ijforecast.2009.01.009
  </a>
  </li>
</ol>

## Image & Article Credits {.scrollable}

- Slide 2 - Pine on power lines, Eversource via FOX61 News (https://www.fox61.com/article/news/local/outreach/awareness-months/crews-busy-as-trees-fall-on-powerlines-across-the-state/520-f1f1a672-f77e-40ed-9ba4-8d3e8aec8b89)